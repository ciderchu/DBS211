SELECT SYSDATE FROM DUAL;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SET AUTOCOMMIT ON;

SELECT * 
FROM RETAILPAYMENTS
WHERE ROWNUM <= 15;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT LASTNAME,FIRSTNAME,EMAIL
FROM RETAILEMPLOYEES
WHERE SALARY > 10000;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
--Method 1

SELECT CONCAT(CONCAT(FIRSTNAME,' '),CONCAT(LASTNAME,' ')) || EMAIL AS "Details - Method1"
FROM RETAILEMPLOYEES
WHERE OFFICECODE = 6;

--Method 2

SELECT FIRSTNAME || ' ' || LASTNAME || ' ' || EMAIL AS "Details - Method2"
FROM RETAILEMPLOYEES
WHERE OFFICECODE = 6;


SELECT CUSTOMERNUMBER,CITY,CUSTOMERNUMBER,CREDITLIMIT
FROM RETAILCUSTOMERS
WHERE CITY = 'Singapore';
-- WHERE (CREDITLIMIT >= 60000 OR CREDITLIMIT <= 90000);

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT CUSTOMERNUMBER,CUSTOMERNAME,CONTACTFIRSTNAME,CONTACTLASTNAME,PHONE
FROM RETAILCUSTOMERS
WHERE CITY = 'Singapore' OR CITY = 'singapore' OR CITY = 'SINGAPORE';

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT CUSTOMERNUMBER,CUSTOMERNAME,CONTACTLASTNAME || ', ' || CONTACTFIRSTNAME AS full_name,PHONE, CREDITLIMIT
FROM RETAILCUSTOMERS
WHERE (CREDITLIMIT >= 60000 AND CREDITLIMIT <= 90000) AND (CITY = 'Singapore');

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT CUSTOMERNUMBER,CUSTOMERNAME,CONTACTLASTNAME || ', ' || CONTACTFIRSTNAME AS full_name,PHONE, CREDITLIMIT
FROM RETAILCUSTOMERS
WHERE (CREDITLIMIT >= 60000 AND CREDITLIMIT <= 90000);

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT CUSTOMERNUMBER
FROM RETAILCUSTOMERS
WHERE ADDRESSLINE2 IS NULL OR ADDRESSLINE2 = '';

SELECT*
FROM RETAILPAYMENTS;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT CUSTOMERNUMBER, CHECKNUMBER, AMOUNT
FROM RETAILPAYMENTS
WHERE (AMOUNT BETWEEN 30000 AND 65000)
    AND EXTRACT(YEAR FROM PAYMENTDATE) = 2004
ORDER BY AMOUNT DESC;

SELECT*
FROM RETAILORDERS;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau

SELECT*
FROM RETAILORDERS
WHERE STATUS = 'Cancelled'
    AND
    EXTRACT(YEAR FROM ORDERDATE) = 2003
;

SELECT*
FROM RETAILPRODUCTS;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT 
    PRODUCTCODE, 
    PRODUCTNAME, 
    BUYPRICE, 
    MSRP, 
    (MSRP - BUYPRICE) AS markup, 
    ROUND(((MSRP - BUYPRICE) / BUYPRICE) * 100, 1) AS permarkup
FROM RETAILPRODUCTS;



SELECT*
FROM RETAILPRODUCTS;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau

SELECT*
FROM RETAILPRODUCTS
WHERE UPPER(PRODUCTNAME) LIKE '%FORD%';


SELECT*
FROM RETAILCUSTOMERS;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
SELECT*
FROM RETAILCUSTOMERS
WHERE UPPER(CONTACTFIRSTNAME) LIKE '%Y'
    AND UPPER(CONTACTFIRSTNAME) LIKE '%A%'
;

SELECT*
FROM RETAILEMPLOYEES;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
INSERT INTO RETAILEMPLOYEES (EMPLOYEENUMBER, LASTNAME, FIRSTNAME, EXTENSION, EMAIL, JOBTITLE, OFFICECODE, REPORTSTO)
VALUES (155131220, 'Chu', 'Sin Kau', 'x123456','skchu3@myseneca.ca', 'Mechanic', 3, 1401);

SELECT*
FROM RETAILEMPLOYEES
WHERE EMPLOYEENUMBER = 155131220;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau

UPDATE RETAILEMPLOYEES SET JOBTITLE = 'Seneior Mechanic' WHERE EMPLOYEENUMBER = 155131220;

SELECT*
FROM RETAILEMPLOYEES
WHERE EMPLOYEENUMBER = 155131220;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
INSERT INTO RETAILEMPLOYEES (EMPLOYEENUMBER, LASTNAME, FIRSTNAME, EXTENSION, EMAIL, JOBTITLE, OFFICECODE, REPORTSTO)
VALUES (155131221, 'Chu', 'Chin Ting', 'x1234567','skchu4@myseneca.ca', 'Manager', 3, 155131220);

SELECT*
FROM RETAILEMPLOYEES
WHERE EMPLOYEENUMBER = 155131221;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
DELETE FROM RETAILEMPLOYEES WHERE EMPLOYEENUMBER = 155131220;


SELECT*
FROM RETAILEMPLOYEES;


SELECT*
FROM 
WHERE EMPLOYEENUMBER = 9999;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
INSERT ALL
    INTO RETAILEMPLOYEES (EMPLOYEENUMBER, LASTNAME, FIRSTNAME, EXTENSION, EMAIL, JOBTITLE, OFFICECODE, REPORTSTO) VALUES (9952, 'Chu', 'Sin Kau', 'x123456','skchu3@myseneca.ca', 'Mechanic', 3, 1401)
    INTO RETAILEMPLOYEES (EMPLOYEENUMBER, LASTNAME, FIRSTNAME, EXTENSION, EMAIL, JOBTITLE, OFFICECODE, REPORTSTO) VALUES (9953, 'Chu', 'Sin Kau', 'x123456','skchu3@myseneca.ca', 'Mechanic', 3, 1401)
SELECT 1 FROM DUAL;

SELECT*
FROM RETAILEMPLOYEES
WHERE EMPLOYEENUMBER = 9952 OR EMPLOYEENUMBER = 9953;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
DELETE FROM RETAILEMPLOYEES
WHERE EMPLOYEENUMBER IN (9952, 9953);

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
INSERT INTO RETAILORDERS (ORDERNUMBER, ORDERDATE, REQUIREDDATE, SHIPPEDDATE, STATUS, COMMENTS, CUSTOMERNUMBER) 
VALUES (10999, '01/04/2024', '20/04/2024', '02/04/2024', 'Shipped', 'Customer ok with.', 311);


SELECT*
FROM RETAILORDERS
WHERE ORDERNUMBER = 10999;

-- Name: Sin Kau Chu, Student ID: 155131220, Date of creation 5/26/2024, NAA-Lab 03_SinKau
INSERT INTO RETAILPRODUCTS (PRODUCTCODE, PRODUCTNAME, PRODUCTLINE, RETAILPRODUCTSCALE, PRODUCTVENDOR, PRODUCTDESCRIPTION, QUANTITYINSTOCK, BUYPRICE, MSRP)
VALUES ('S20_2024', '2024 Ferrari Portofin', 'Classic Cars', '1:18', 'Autoart Studio Design', '1969 Ford Mustang', 100, 55.00, 75.00);


SELECT*
FROM RETAILPRODUCTS
WHERE PRODUCTCODE = 'S20_2024';

